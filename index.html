<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Impostores - Online</title>
  <link rel="stylesheet" href="css/styles.css" />
</head>

<body>
  <div class="wrap">
    
    <div id="loginInterface" class="card" style="max-width: 450px; margin: 40px auto; text-align: center;">
      <h2 style="font-size: 28px; margin-bottom: 8px;">üïµÔ∏è‚Äç‚ôÇÔ∏è Impostores</h2>
      <p class="muted" style="margin-bottom: 24px;">Juega en l√≠nea con tus amigos</p>
      
      <div style="text-align: left;">
        <label class="hint">Tu Nombre:</label>
        <input id="loginName" type="text" placeholder="Ej. EDGAR" style="margin-bottom: 20px; font-weight: bold; font-size: 16px; text-transform: uppercase;" />
        <button id="btnCreateRoom" class="full-width">Crear Nueva Sala</button>
      </div>

      <div style="margin: 30px 0; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 24px; text-align: left;">
        <label class="hint">¬øTienes un c√≥digo?</label>
        <div class="hostGate" style="margin-top: 8px;">
          <input id="loginRoomCode" type="text" placeholder="C√ìDIGO" style="text-transform: uppercase; font-weight: bold; letter-spacing: 2px;" />
          <button id="btnJoinRoom" class="ghost btn-auto">Unirse</button>
        </div>
      </div>
    </div>

    <div id="gameInterface" class="hidden">
      <header>
        <div class="header-titles">
          <h1>Impostores</h1>
          <p id="roomCodeDisplay" style="font-weight: bold; color: var(--accent); font-size: 16px;">Sala: ----</p>
        </div>
        <div class="header-actions">
          <button id="openConfigBtn" class="ghost btn-sm hidden">‚öôÔ∏è Ajustes de Anfitri√≥n</button>
          <div class="pill">
            <span class="dot" id="phaseDot"></span>
            <span id="phaseText">Esperando jugadores...</span>
          </div>
        </div>
      </header>

      <div class="grid">
        <div class="col">
          <section class="card" style="min-height: 300px;">
            <div class="row">
              <h2>Tablero de Jugadores</h2>
              <span class="badge" id="roundBadge">Ronda: 0</span>
            </div>

            <div class="controls" id="hostGameControls" style="display: none;">
              <button id="startBtn" disabled>Iniciar nueva ronda</button>
              <button id="startVotingBtn" class="danger hidden">Iniciar Votaci√≥n</button>
              <button id="endRoundBtn" class="ghost hidden">Cerrar Ronda</button>
            </div>

            <div class="names" id="namesGrid" style="margin-top: 16px;"></div>
          </section>
        </div>

        <div class="col">
          <section class="card">
            <div class="row"><h2>Puntuaci√≥n</h2></div>
            <div class="table-responsive">
              <table class="table" id="scoreTable">
                <thead><tr><th>Jugador</th><th>Puntos</th></tr></thead>
                <tbody id="scoreTableBody"></tbody>
              </table>
            </div>
          </section>

          <section class="card hidden" id="hostSecretPanelCard">
            <div class="row"><h2>Panel de Anfitri√≥n</h2></div>
            <div class="hint" style="margin-bottom: 10px;">Ingresa el PIN para ver los roles de la ronda actual.</div>
            <div class="hostGate">
              <input id="pinInput" type="password" inputmode="numeric" placeholder="Ingresar PIN" />
              <button id="openHostBtn" class="ghost btn-auto">Ver Roles</button>
              <button id="closeHostBtn" class="ghost btn-auto" disabled>Ocultar</button>
            </div>
            <div id="pinErrorMsg" class="hint error-msg" style="color: var(--bad); display: none; margin-top: 8px;">PIN incorrecto.</div>
            
            <div class="hostPanel hidden" id="hostPanel">
              <div class="table-responsive">
                <table class="table" id="hostTable"></table>
              </div>
            </div>
          </section>
        </div>
      </div>
    </div>
  </div>

  <div class="overlay" id="votingOverlay">
    <div class="cardModal mini-modal text-center">
      <h3 style="color: var(--bad);">Hora de Votar</h3>
      <p class="my-16">¬øQui√©n crees que es el impostor? Selecciona para eliminarlo.</p>
      <div id="votingOptions" class="action-buttons" style="flex-direction: column; gap: 8px;"></div>
      <div id="votingWaiting" class="hint hidden mt-16">Esperando los votos de los dem√°s...</div>
      
      <div id="votingHostControls" class="hidden" style="margin-top: 20px; padding-top: 15px; border-top: 1px solid rgba(255,255,255,0.1);">
        <button id="forceCalculateVotesBtn" class="danger full-width">Forzar Resultados (Anfitri√≥n)</button>
      </div>
    </div>
  </div>

  <div class="overlay" id="resolutionOverlay">
    <div class="cardModal mini-modal text-center">
      <h3 id="resolutionTitle">Resultado de la Votaci√≥n</h3>
      <div id="resolutionRole" class="big my-16" style="font-size: 30px;">‚Äî</div>
      <p id="resolutionStatus" class="hint mb-16">Revisando estado de la partida...</p>
      
      <div id="resolutionHostControls" class="action-buttons justify-center mt-16 hidden">
        <button id="btnContinueGame" class="ghost">Volver a la Ronda</button>
        <button id="btnGoToScore" class="danger">Finalizar y Puntuar</button>
      </div>
      <div class="hint hidden mt-16" id="resolutionWaiting">Esperando decisi√≥n del anfitri√≥n...</div>
    </div>
  </div>

  <div class="overlay" id="configOverlay">
    <div class="cardModal scrollable-modal">
      <div class="modalTop sticky-top">
        <h3>‚öôÔ∏è Ajustes de Anfitri√≥n</h3>
        <button class="closeX" id="closeConfigBtn" type="button">Cerrar</button>
      </div>
      <div class="modal-content-stack">
        
        <div class="panel">
          <h4>1. Gesti√≥n de Jugadores</h4>
          <div class="hint" style="margin-bottom: 8px;">Expulsa a jugadores inactivos.</div>
          <div class="player-list" id="hostPlayerList">
            <div class="hint">Cargando jugadores...</div>
          </div>
        </div>

        <div class="panel">
          <h4>2. Reglas de la Ronda</h4>
          <div class="controls stack-mobile">
            <label class="badge badge-select">Modo: <select id="topicMode"><option value="mixed" selected>Mezclado</option><option value="single">Un solo tema</option></select></label>
            <label class="badge badge-select">Tema: <select id="topicSelect"></select></label>
            <label class="badge badge-select">Impostores: <select id="impostorSelect"><option value="1" selected>1</option><option value="2">2</option></select></label>
          </div>
        </div>

        <div class="panel">
          <h4>3. Seguridad del Anfitri√≥n</h4>
          <div class="hostGate">
            <input id="setupPinInput" type="password" inputmode="numeric" placeholder="Ej: 1234" />
            <button id="savePinBtn" class="ghost btn-auto">Guardar PIN</button>
            <span id="pinStatus" class="hint success-msg" style="color: var(--ok); display: none;">¬°PIN Guardado!</span>
          </div>
        </div>

        <div class="panel">
          <h4>4. Palabras Personalizadas</h4>
          <div class="hostGate split-inputs">
            <input id="customWordInput" type="text" placeholder="Palabra exacta" />
            <input id="customClueInput" type="text" placeholder="Pista para impostor" />
            <button id="addCustomWordBtn" class="ghost btn-auto">A√±adir</button>
          </div>
          <div class="hint" id="customWordCountBadge" style="margin-top:8px; color: var(--ok);">0 palabras personalizadas en la sala.</div>
        </div>

        <div class="panel border-danger">
          <h4 class="text-danger">Opciones del Sistema</h4>
          <button id="resetGameBtn" class="ghost full-width mt-8 text-danger" style="border-color: var(--bad);">Resetear Sala (Puntos a 0)</button>
          <button id="destroyRoomBtn" class="danger full-width mt-8" style="background: linear-gradient(135deg, #ff0000, #8b0000); color: white;">Destruir Sala Definitivamente</button>
        </div>

        <button id="saveConfigBtn" class="full-width mt-8" style="background: var(--ok); color: #000; border: none;">Guardar Configuraci√≥n</button>
      </div>
    </div>
  </div>

  <div class="overlay" id="overlay">
    <div class="cardModal">
      <div class="modalTop">
        <div><h3 id="modalTitle">Carta</h3><div class="muted" id="modalSub">‚Äî</div></div>
        <button class="closeX" id="closeOverlayBtn" type="button">Cerrar</button>
      </div>
      <div class="modalBody">
        <div class="panel"><h4>Tu rol</h4><div class="big" id="roleBig">‚Äî</div><div class="hint" id="roleExplain">‚Äî</div></div>
        <div class="panel">
          <h4>Informaci√≥n</h4>
          <div class="revealBox" id="revealBox">
            <div id="revealContent"></div>
            <div class="cover" id="cover">
              <div class="cover-title">Oculto</div>
              <div class="hint mt-6">Mant√©n presionado o usa la tecla <span class="kbd">Espacio</span> para revelar.</div>
              <div class="mt-10"><button class="holdBtn" id="holdBtn" type="button">Revelar</button></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="overlay" id="scoreOverlay">
    <div class="cardModal mini-modal">
      <div class="modalTop"><h3>Fin de la Ronda</h3><button class="closeX" id="closeScoreOverlayBtn" type="button">Cancelar</button></div>
      <div class="mt-16"><p>¬øQui√©n gan√≥ esta ronda?</p>
        <div class="score-buttons">
          <button id="winInnocentsBtn" class="ghost score-btn"><strong>üü¢ Inocentes ganan</strong><br><span>Descubrieron al impostor (+1 a Inocentes)</span></button>
          <button id="winImpostorBtn" class="ghost score-btn"><strong>üî¥ Impostores ganan</strong><br><span>No fueron descubiertos (+3 a Impostores)</span></button>
          <button id="winImpostorWordBtn" class="ghost score-btn"><strong>üü° Empate / Robo</strong><br><span>Descubierto, pero adivin√≥ la palabra exacta (+2 a Impostores)</span></button>
          <button id="winNobodyBtn" class="ghost score-btn nobody-btn"><strong>‚ö™ Nadie punt√∫a</strong><br><span>Solo terminar ronda</span></button>
        </div>
      </div>
    </div>
  </div>

  <div class="overlay" id="resetOverlay">
    <div class="cardModal mini-modal text-center">
      <h3 style="color: var(--bad); margin-top: 0;">‚ö†Ô∏è Advertencia</h3>
      <p class="my-16" id="resetWarningText">¬øEst√°s seguro?</p>
      <div style="display:flex; gap:10px; justify-content:center; margin-top: 20px;">
        <button id="cancelResetBtn" class="ghost">Cancelar</button>
        <button id="confirmActionBtn" class="danger">S√≠, confirmar</button>
      </div>
    </div>
  </div>

  <div id="toast" class="toast hidden">Mensaje de notificaci√≥n</div>

  <footer class="footer-copy">
    &copy; Dise√±o base por <strong>Juan</strong>
  </footer>

  <script src="js/data.js"></script>
  <script type="module" src="js/main.js"></script>
</body>
</html>